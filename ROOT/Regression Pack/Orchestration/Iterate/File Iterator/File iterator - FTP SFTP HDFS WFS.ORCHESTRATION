{"job":{"components":{"3217":{"id":3217,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1058406652,"x":-32,"y":-16,"width":32,"height":16,"inputConnectorIDs":[3241],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"File Iterator 0"}}}},"visible":true},"2":{"slot":2,"name":"Input Data Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FTP"}}}},"visible":true},"3":{"slot":3,"name":"Set Home Directory as Root","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"4":{"slot":4,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ftp://10.12.2.69/"}}}},"visible":true},"5":{"slot":5,"name":"Recursive","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"mtltestuser"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"mtltestuser"}}}},"visible":true},"8":{"slot":8,"name":"SFTP Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"9":{"slot":9,"name":"Filter Regex","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":".*"}}}},"visible":true},"10":{"slot":10,"name":"Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_iterator_printer"},"2":{"slot":2,"type":"STRING","value":"Base Folder"}}}},"visible":true},"11":{"slot":11,"name":"Ignore Hidden","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"12":{"slot":12,"name":"Domain","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"13":{"slot":13,"name":"Max Recursion Depth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"6"}}}},"visible":false},"14":{"slot":14,"name":"Max Iterations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"25"}}}},"visible":true},"15":{"slot":15,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"16":{"slot":16,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"17":{"slot":17,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"18":{"slot":18,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"gs://<bucket>/<path>"}}}},"visible":false},"19":{"slot":19,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://<account>/<container>/<path>"}}}},"visible":false},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[3252],"inputIterationConnectorIDs":[]},"3218":{"id":3218,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-158614544,"x":288,"y":176,"width":32,"height":16,"inputConnectorIDs":[3242],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry 2"}}}},"visible":true},"2":{"slot":2,"name":"Number of Retries","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${close_server_retry}"}}}},"visible":true},"3":{"slot":3,"name":"Retry Delay","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry immediately"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[3253],"inputIterationConnectorIDs":[]},"3219":{"id":3219,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":288,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Stop Hadoop Container"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import docker\nimport json\nimport time\n\n# docker details\ndocker_url = 'docker-aws.dc.matillion.com'\ndocker_port = '2376'\ndocker_version = '1.24'\nimage = 'matillion/hadoop'\n\n# Stop a container with the specified name\ndocker_client = docker.client.DockerClient(base_url='tcp://' + docker_url + ':' + docker_port, version=docker_version)\ncontainer = docker_client.containers.get(HDFS_CONTAINER)\ncontainer.stop()\ncontainer.remove()\n\nprint \"Stopping and removing container: %s\" % (HDFS_CONTAINER)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 2"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[3253]},"3220":{"id":3220,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1058406652,"x":128,"y":176,"width":32,"height":16,"inputConnectorIDs":[3238],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[3244],"outputUnconditionalConnectorIDs":[3242],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"File Iterator 2"}}}},"visible":true},"2":{"slot":2,"name":"Input Data Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"HDFS"}}}},"visible":true},"3":{"slot":3,"name":"Set Home Directory as Root","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"4":{"slot":4,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"hdfs://10.12.5.85:${HDFS_PORT}/user/root/input/"}}}},"visible":true},"5":{"slot":5,"name":"Recursive","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"8":{"slot":8,"name":"SFTP Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"9":{"slot":9,"name":"Filter Regex","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":".*"}}}},"visible":true},"10":{"slot":10,"name":"Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_iterator_printer"},"2":{"slot":2,"type":"STRING","value":"Filename"}}}},"visible":true},"11":{"slot":11,"name":"Ignore Hidden","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":false},"12":{"slot":12,"name":"Domain","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"13":{"slot":13,"name":"Max Recursion Depth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"6"}}}},"visible":false},"14":{"slot":14,"name":"Max Iterations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"25"}}}},"visible":true},"15":{"slot":15,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"16":{"slot":16,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"17":{"slot":17,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"18":{"slot":18,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"gs://<bucket>/<path>"}}}},"visible":false},"19":{"slot":19,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://<account>/<container>/<path>"}}}},"visible":false},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[3248],"inputIterationConnectorIDs":[]},"3221":{"id":3221,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-32,"y":112,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SFTP"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[3251]},"3222":{"id":3222,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1058406652,"x":-32,"y":80,"width":32,"height":16,"inputConnectorIDs":[3239],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"File Iterator 1"}}}},"visible":true},"2":{"slot":2,"name":"Input Data Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SFTP"}}}},"visible":true},"3":{"slot":3,"name":"Set Home Directory as Root","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"4":{"slot":4,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sftp://mtlsftpuptest:mtlsftpuptest@10.12.2.69:22/"}}}},"visible":true},"5":{"slot":5,"name":"Recursive","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":true},"8":{"slot":8,"name":"SFTP Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"9":{"slot":9,"name":"Filter Regex","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":".*"}}}},"visible":true},"10":{"slot":10,"name":"Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_iterator_printer"},"2":{"slot":2,"type":"STRING","value":"Filename"}}}},"visible":true},"11":{"slot":11,"name":"Ignore Hidden","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"12":{"slot":12,"name":"Domain","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"13":{"slot":13,"name":"Max Recursion Depth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"6"}}}},"visible":false},"14":{"slot":14,"name":"Max Iterations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"25"}}}},"visible":true},"15":{"slot":15,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"16":{"slot":16,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"17":{"slot":17,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"18":{"slot":18,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"gs://<bucket>/<path>"}}}},"visible":false},"19":{"slot":19,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://<account>/<container>/<path>"}}}},"visible":false},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[3251],"inputIterationConnectorIDs":[]},"3223":{"id":3223,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-32,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start Hadoop Container"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import docker\nimport json\nimport time\nimport requests\n\n# docker details\ndocker_url = 'docker-aws.dc.matillion.com'\ndocker_port = '2376'\ndocker_version = '1.24'\nimage = 'matillion/hadoop'\n\n# Launch a container for the specified image with the specified name\ndef launch_container(docker_client, image):\n  ports = {'9000/tcp': None}\n  labels = {'software': 'hdfs'}\n  new_container = docker_client.containers.run(image, ports=ports, command='/etc/bootstrap.sh -d', detach=True, labels=labels)\n  return new_container\n\ndocker_client = docker.client.DockerClient(base_url='tcp://' + docker_url + ':' + docker_port, version=docker_version)\nnew_container = launch_container(docker_client, image)\nhdfs_container = new_container.name\nresult = docker_client.containers.get(hdfs_container)\n\nwhile result.status != 'running':\n  result = docker_client.containers.get(hdfs_container)\n  time.sleep(1)\n\nhdfs_port = str(result.attrs['NetworkSettings']['Ports']['9000/tcp'][0]['HostPort'])\n\ncontext.updateVariable(\"HDFS_CONTAINER\", hdfs_container)\ncontext.updateVariable(\"HDFS_PORT\", hdfs_port)\n\nprint \"Launching container: %s\\nHDFS Port: %s\" % (hdfs_container, hdfs_port)\n\ndocker_host_ip = 'http://10.12.5.85:2376/'\nurl = 'http://docker.dc.matillion.com:4200/docker/container/destruction/?name=' + result.id + '&host=' + docker_host_ip + '&timeAmount=4&timeUnits=Hours'\nresponse = requests.post(url, data={})\n\ntime.sleep(15)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 2"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[3246]},"3224":{"id":3224,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":128,"y":400,"width":32,"height":32,"inputConnectorIDs":[3245],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"3225":{"id":3225,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-32,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FTP"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[3252]},"3226":{"id":3226,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-158614544,"x":-32,"y":288,"width":32,"height":16,"inputConnectorIDs":[3243],"outputSuccessConnectorIDs":[3237],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Retry 0"}}}},"visible":true},"2":{"slot":2,"name":"Number of Retries","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${close_server_retry}"}}}},"visible":true},"3":{"slot":3,"name":"Retry Delay","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry immediately"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[3250],"inputIterationConnectorIDs":[]},"3227":{"id":3227,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-32,"y":320,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start Samba Container"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import docker\nimport json\nimport time\nimport requests\n\n# docker details\ndocker_url = 'docker-aws.dc.matillion.com'\ndocker_port = '2376'\ndocker_version = '1.24'\nimage = 'matillion/samba'\n\n# Launch a container for the specified image with the specified name\ndef launch_container(docker_client, image):\n  ports = {'445/tcp': None}\n  labels = {'software': 'samba'}\n  new_container = docker_client.containers.run(image, ports=ports, detach=True, labels=labels)\n  return new_container\n\ndocker_client = docker.client.DockerClient(base_url='tcp://' + docker_url + ':' + docker_port, version=docker_version)\nnew_container = launch_container(docker_client, image)\nsamba_container = new_container.name\nresult = docker_client.containers.get(samba_container)\n\nwhile result.status != 'running':\n  result = docker_client.containers.get(samba_container)\n  time.sleep(1)\n\nsamba_port = str(result.attrs['NetworkSettings']['Ports']['445/tcp'][0]['HostPort'])\n\ncontext.updateVariable(\"SAMBA_CONTAINER\", samba_container)\ncontext.updateVariable(\"SAMBA_PORT\", samba_port)\n\nprint \"Launching container: %s\\nSMB Port: %s\" % (samba_container, samba_port)\n\ndocker_host_ip = 'http://10.12.5.85:2376/'\nurl = 'http://docker.dc.matillion.com:4200/docker/container/destruction/?name=' + result.id + '&host=' + docker_host_ip + '&timeAmount=4&timeUnits=Hours'\nresponse = requests.post(url, data={})\n\ntime.sleep(5)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 2"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[3250]},"3228":{"id":3228,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-158614544,"x":288,"y":288,"width":32,"height":16,"inputConnectorIDs":[3236],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Retry 2"}}}},"visible":true},"2":{"slot":2,"name":"Number of Retries","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${close_server_retry}"}}}},"visible":true},"3":{"slot":3,"name":"Retry Delay","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry immediately"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[3249],"inputIterationConnectorIDs":[]},"3229":{"id":3229,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":128,"y":80,"width":32,"height":32,"inputConnectorIDs":[3244],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"3230":{"id":3230,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":128,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"HDFS"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 2"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[3248]},"3231":{"id":3231,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":128,"y":320,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WFS"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 2"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[3247]},"3232":{"id":3232,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":288,"y":320,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Stop Samba Container"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import docker\nimport json\nimport time\n\n# docker details\ndocker_url = 'docker-aws.dc.matillion.com'\ndocker_port = '2376'\ndocker_version = '1.24'\n\n# Stop a container with the specified name\ndocker_client = docker.client.DockerClient(base_url='tcp://' + docker_url + ':' + docker_port, version=docker_version)\ncontainer = docker_client.containers.get(SAMBA_CONTAINER)\ncontainer.stop()\ncontainer.remove()\n\nprint \"Stopping and removing container: %s\" % (SAMBA_CONTAINER)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 2"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[3249]},"3233":{"id":3233,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-158614544,"x":-32,"y":176,"width":32,"height":16,"inputConnectorIDs":[3240],"outputSuccessConnectorIDs":[3238],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry 0"}}}},"visible":true},"2":{"slot":2,"name":"Number of Retries","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${close_server_retry}"}}}},"visible":true},"3":{"slot":3,"name":"Retry Delay","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry immediately"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[3246],"inputIterationConnectorIDs":[]},"3234":{"id":3234,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1058406652,"x":128,"y":288,"width":32,"height":16,"inputConnectorIDs":[3237],"outputSuccessConnectorIDs":[3236],"outputFailureConnectorIDs":[3245],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"File Iterator 3"}}}},"visible":true},"2":{"slot":2,"name":"Input Data Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Windows Fileshare"}}}},"visible":true},"3":{"slot":3,"name":"Set Home Directory as Root","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"4":{"slot":4,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smb://10.12.5.85:${SAMBA_PORT}/private/"}}}},"visible":true},"5":{"slot":5,"name":"Recursive","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"matillion"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"matillion"}}}},"visible":true},"8":{"slot":8,"name":"SFTP Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"9":{"slot":9,"name":"Filter Regex","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":".*"}}}},"visible":true},"10":{"slot":10,"name":"Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_iterator_printer"},"2":{"slot":2,"type":"STRING","value":"Filename"}}}},"visible":true},"11":{"slot":11,"name":"Ignore Hidden","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"12":{"slot":12,"name":"Domain","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WORKGROUP"}}}},"visible":true},"13":{"slot":13,"name":"Max Recursion Depth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"6"}}}},"visible":false},"14":{"slot":14,"name":"Max Iterations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"25"}}}},"visible":true},"15":{"slot":15,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"16":{"slot":16,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"17":{"slot":17,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"18":{"slot":18,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"gs://<bucket>/<path>"}}}},"visible":false},"19":{"slot":19,"name":"Input Data URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://<account>/<container>/<path>"}}}},"visible":false},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[3247],"inputIterationConnectorIDs":[]},"3235":{"id":3235,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-153,"y":129,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[3239,3240,3241,3243],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"3236":{"id":3236,"sourceID":3234,"targetID":3228},"3237":{"id":3237,"sourceID":3226,"targetID":3234},"3238":{"id":3238,"sourceID":3233,"targetID":3220}},"failureConnectors":{"3244":{"id":3244,"sourceID":3220,"targetID":3229},"3245":{"id":3245,"sourceID":3234,"targetID":3224}},"unconditionalConnectors":{"3239":{"id":3239,"sourceID":3235,"targetID":3222},"3240":{"id":3240,"sourceID":3235,"targetID":3233},"3241":{"id":3241,"sourceID":3235,"targetID":3217},"3242":{"id":3242,"sourceID":3220,"targetID":3218},"3243":{"id":3243,"sourceID":3235,"targetID":3226}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"3246":{"id":3246,"sourceID":3233,"targetID":3223},"3247":{"id":3247,"sourceID":3234,"targetID":3231},"3248":{"id":3248,"sourceID":3220,"targetID":3230},"3249":{"id":3249,"sourceID":3228,"targetID":3232},"3250":{"id":3250,"sourceID":3226,"targetID":3227},"3251":{"id":3251,"sourceID":3222,"targetID":3221},"3252":{"id":3252,"sourceID":3217,"targetID":3225},"3253":{"id":3253,"sourceID":3218,"targetID":3219}},"noteConnectors":{},"notes":{"3216":{"id":3216,"x":408,"y":122,"width":329,"height":137,"text":"**File Iterator**\n\nBasic test suite the variable file_iterator_printer will loop around the Filename\n\nFTP\nSFTP\nHDFS\nWFS","colour":"e6e63c"}},"variables":{"file_iterator_printer":{"definition":{"name":"file_iterator_printer","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{}},"info":{"name":"File iterator - FTP SFTP HDFS WFS","description":"","type":"ORCHESTRATION","tag":"cd2a82c5-543f-4951-89dc-456da0df3016"}}